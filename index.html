<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <title>Colorizing Glass Plate Images</title>
    <style>
        .bg-image {
            background-repeat: no-repeat;
            background-size: cover;
            background-position: center;
            height: 600px;
            width: 100%;
        }
        .figure img { max-height: 400px; width: auto; }
    </style>
    <script>
        $(window).scroll(function() {
            $(".bg-image-color").css("opacity", $(window).scrollTop() / 250);
        });
    </script>
</head>
<body>
    <div class="bg-image text-center" style="background-image: url('data/cathedral.jpg');">
        <div class="mask" style="background-color: rgba(0, 0, 0, 0.2);"></div>
        <div class="d-flex justify-content-center align-items-center h-100 text-white" style="text-shadow: 0 0 5px black;">
            <div>
                <h1>Colorizing the Prokudin-Gorskii photo collection</h1>
                <h4>Kenny Chan</h4>
                <h5>SID:3040782826</h5>
                <h6>CS180 Project 1</h6>
            </div>
        </div>
    </div>
    <div class="bg-image bg-image-color" style="background-image: url('processed_image/cathedral.jpg'); position: absolute; top:0; left:0; z-index: 9; opacity: 0;"></div>

    <div class="container p-5" id="overview">
        <h2>Project Overview</h2>
        <p>This project focuses on aligning and colorizing digitized glass plate photographs from the Prokudin-Gorskii collection. The original photographs were taken by Sergei Mikhailovich Prokudin-Gorskii using red, green, and blue filters, creating three separate exposures for each scene. The digitized version of these plates contains all three exposures stacked vertically in a single image.</p>
        <p>The objective is to split these stacked images into their respective red, green, and blue channels, and then apply image processing techniques to align the plates correctly. Once aligned, the channels can be merged to produce a fully colored image with minimal artifacts.</p>
        <div class="text-center">
            <figure class="figure">
                <div class="row">
                    <div class="col-md-4"><img src="data/cathedral.jpg" class="img-fluid" alt="Cathedral image"></div>
                    <div class="col-md-4"><img src="data/monastery.jpg" class="img-fluid" alt="Monastery image"></div>
                    <div class="col-md-4"><img src="data/tobolsk.jpg" class="img-fluid" alt="Tobolsk image"></div>
                </div>
                <figcaption class="figure-caption">Examples of glass plate digitizations.</figcaption>
            </figure>
        </div>
    </div>

    <div class="container px-5" id="approach">
        <h2>Approach</h2>
        <p>The alignment process uses Normalized Cross-Correlation (NCC) to compare how well the images match each other after applying various displacements. The blue channel is used as the reference, and the red and green channels are aligned to it by searching for the best shift in both the x and y directions.</p>
        <p>The process is improved by using an image pyramid technique, which first aligns downscaled versions of the images to estimate the shift for the larger, original images. This approach speeds up the computation, as it reduces the number of possible displacements to be tested at higher resolutions. Specifically, each plate is progressively downscaled, and the alignment is performed on the smallest version of the image, refining the alignment as the resolution increases.</p>
        <p>The algorithm also includes a multiprocessing feature, allowing the program to parallelize the alignment of the green and red channels, further improving speed.</p>
        <p>Finally, an automatic cropping function is applied to remove any unnecessary borders that may affect the alignment process, ensuring a clean and focused final output image. The result is saved as a new color image, which can then be displayed and analyzed.</p>
    </div>

    <div class="container px-5" id="results">
        <h2>Results</h2>
        <table class="table table-bordered text-center">
            <tr><td colspan="3"><b>Low-Quality Images (jpg)</b></td></tr>
            <tr>
                <td><img src="processed_image/cathedral.jpg" class="img-fluid rounded" alt="Cathedral"><br>Displacement: G (5, 2); R (12, 3)</td>
                <td><img src="processed_image/monastery.jpg" class="img-fluid rounded" alt="Monastery"><br>Displacement: G (-3, 2); R (3, 2)</td>
                <td><img src="processed_image/tobolsk.jpg" class="img-fluid rounded" alt="Tobolsk"><br>Displacement: G (3, 3); R (6, 3)</td>
            </tr>
            <tr><td colspan="3"><b>High-Quality Images (tiff)</b></td></tr>
            <tr>
                <td><img src="processed_image/church.jpg" class="img-fluid rounded" alt="Church"><br>Displacement: G (0,-2); R (26,-7)</td>
                <td><img src="processed_image/emir.jpg" class="img-fluid rounded" alt="Emir"><br>Displacement: G (-2,7); R (44,16)</td>
                <td><img src="processed_image/harvesters.jpg" class="img-fluid rounded" alt="Harvesters"><br>Displacement: G (56,0); R (56,1)</td>
                <td><img src="processed_image/icon.jpg" class="img-fluid rounded" alt="Icon"><br>Displacement: G (44,23); R (37,3)</td>
                <td><img src="processed_image/lady.jpg" class="img-fluid rounded" alt="Lady"><br>Displacement: G (30,-16); R (30,-28)</td>
                <td><img src="processed_image/melons.jpg" class="img-fluid rounded" alt="Melons"><br>Displacement: G (37, 0); R (59, -3)</td>
                <td><img src="processed_image/onion_church.jpg" class="img-fluid rounded" alt="Onion Church"><br>Displacement: G (30,0); R (30,-1)</td>
                <td><img src="processed_image/sculpture.jpg" class="img-fluid rounded" alt="Sculpture"><br>Displacement: G (30,-19); R (30,-4)</td>
                <td><img src="processed_image/self_portrait.jpg" class="img-fluid rounded" alt="Self Portrait"><br>Displacement: G (30,-5); R (30,-11)</td>
                <td><img src="processed_image/three_generations.jpg" class="img-fluid rounded" alt="Three Generations"><br>Displacement: G (30,3); R (30,5)</td>
                <td><img src="processed_image/train.jpg" class="img-fluid rounded" alt="Train"><br>Displacement: G (0,-12); R (30,-3)</td>
            </tr>
        </table>
    </div>
</body>
</html>
